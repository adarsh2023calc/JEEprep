<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Score Analysis</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    p::first-letter , span::first-letter {
      text-transform: uppercase;
      }
    
  </style>

  <script>
    function getCookie(name) {
      let cookieValue = null;
      const cookies = document.cookie.split(";");

      for (let cookie of cookies) {
        cookie = cookie.trim();
        if (cookie.startsWith(name + "=")) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        }
      }
      return cookieValue;
    }

    const csrftoken = getCookie("csrftoken")
  </script>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center">

  <div class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-md">
    <h2 class="text-2xl font-bold mb-4 text-center">Score Analysis</h2>

    <!-- Pie Chart Canvas -->
    <canvas id="scoreChart"></canvas>

    <!-- Summary -->
    <div class="mt-6 text-center space-y-1">
      <p class="text-lg font-semibold">Correct: <span id="correctCount"></span></p>
      <p class="text-lg font-semibold">Wrong: <span id="wrongCount"></span></p>
      <p class="text-lg font-semibold">Unattempted: <span id="unattemptedCount"></span></p>
    </div>


    <div class="mt-6 flex gap-3 justify-center">
      <button onclick="showSection('correct')" class="px-4 py-2 bg-green-500 text-white rounded-lg">
        Correct Answers
      </button>
      <button onclick="showSection('wrong')" class="px-4 py-2 bg-red-500 text-white rounded-lg">
        Incorrect Answers
      </button>
      <button onclick="showSection('unattempted')" class="px-4 py-2 bg-yellow-600 text-white rounded-lg">
        Unattempted
      </button>
    </div>

    <!-- Display area -->
    <div id="displayArea" class="mt-6 space-y-3"></div>

   
  </div>

  <script>
    // Example data (replace these with your JS variables)
    const correct = localStorage.getItem("correct");
    const wrong = localStorage.getItem("incorrect");
    const unattempted = localStorage.getItem("unattempted");

    // Update HTML text
    document.getElementById("correctCount").textContent = correct;
    document.getElementById("wrongCount").textContent = wrong;
    document.getElementById("unattemptedCount").textContent = unattempted;

    
    
      
    // Pie Chart Code
    const ctx = document.getElementById("scoreChart");

    new Chart(ctx, {
      type: "pie",
      data: {
        labels: ["Correct", "Wrong","Unattempted"],
        datasets: [{
          data: [correct, wrong,unattempted],
          backgroundColor: [
            "#22c55e",  // green
            "#ef4444",  // red
            "#a3a3a3"   // gray
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: "bottom"
          }
        }
      }
    });


    function showSection(section){


      const display = document.getElementById("displayArea");
      display.innerHTML = ""; // Clear previous content

      correctList = JSON.parse(localStorage.getItem("correctQuestion"));
      incorrectList= JSON.parse(localStorage.getItem("incorrectQuestion"));

      unattemptedList = JSON.parse(localStorage.getItem("unattemptedQuestions"));
      if(section ==="correct"){
        
        correctList.forEach(key => {
          display.innerHTML+=
          `<div class="p-3 bg-green-100 rounded-lg">
              <p><strong>Q:</strong><span>${key.question}</span></p>
              <p><strong>Correct Answer:</strong><span>${key.answer}</span></p>
              <p><strong>Topic:</strong><span>${key.topic}</span></p>
            </div>`;
        });
      }

      else if(section ==="wrong"){

        incorrectList.forEach(question=> {

          display.innerHTML+=
          `<div class="p-3 bg-red-100 rounded-lg">
              <p><strong>Q:</strong><span>${question.question}</span></p>
              <p><strong>Correct Answer:</strong><span>${question.answer}</span></p>
               <p><strong>Topic:</strong><span>${question.topic}</span></p>
            </div>`;
        });
      }

      else{

        unattemptedList.forEach(question => {
          display.innerHTML+=
          `<div class="p-3 bg-yellow-100 rounded-lg">
              <p><strong>Q:</strong><span>${question.question}</span></p>
              <p><strong>Correct Answer:</strong><span>${question.answer}</span></p>
               <p><strong>Topic:</strong> <span>${question.topic}</span></p>
            </div>`;
        });

      }

    }
  </script>

</body>
</html>
